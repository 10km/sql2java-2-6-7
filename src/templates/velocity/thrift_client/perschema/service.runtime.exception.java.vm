#parse( "header.include.vm" )
#if(!$codewriter.existsDependencyPackage())
$codewriter.setSaveCurrentFile(false);
#stop
#end
## swift生成的client代码的package
#set ( $thriftPackage = ${codewriter.getDependencyPackage()})
#set ( $javaClassName = "ServiceRuntimeException" )
$codewriter.setCurrentJavaFilename("${schemaPkg}", "${javaClassName}.java")
package ${schemaPkg};

import java.io.PrintStream;
import java.io.PrintWriter;

import com.google.common.base.Preconditions;

/**
 * Runtime exception wrap class<br>
 * all {@link RuntimeException} threw from service was wrapped to the exception<br>
 * catch the exception to retrieve detail error message from service<br>
 * retrieve service stack trace message by call {@link #getServiceStackTraceMessage()}<br>
 * get exception type by call {@link getType()}
 * @author guyadong
 *
 */
public final class ServiceRuntimeException extends RuntimeException {
    private static final long serialVersionUID = 1L;
    private final int type;
    private String message;
    private String causeClass;
    private final String causeFields;
    private final String serviceStackTraceMessage;

    /**
     * @param cause
     */
    ServiceRuntimeException(${thriftPackage}.ServiceRuntimeException cause) {
        super(cause);
        type = cause.getType();
        message = cause.getMessage();
        causeClass = cause.getCauseClass();
        causeFields = cause.getCauseFields();
        serviceStackTraceMessage = cause.getServiceStackTraceMessage();
    }

    /**
     * print stack trace message from service to {@link System#err}
     * @see ${esc.hash}printStackTrace()
     */
    public void printServiceStackTrace() {
        printServiceStackTrace(System.err);
    }

    /**
     * @param s
     * @see ${esc.hash}printServiceStackTrace()
     * @see ${esc.hash}printStackTrace(PrintStream)
     * @throws NullPointerException s is {@code null}
     */
    public void printServiceStackTrace(PrintStream s) {
        synchronized (Preconditions.checkNotNull(s)) {
            s.println(serviceStackTraceMessage);
        }
    }

    /**
     * @param s
     * @see ${esc.hash}printServiceStackTrace()
     * @see ${esc.hash}printStackTrace(PrintWriter)
     * @throws NullPointerException s is {@code null}
     */
    public void printServiceStackTrace(PrintWriter s) {
        synchronized (Preconditions.checkNotNull(s)) {
            s.println(serviceStackTraceMessage);
        }
    }
    /** return error message from service */
    @Override
    public String getMessage() {
        return message;
    }
    /** return cause exception class name */
    public String getCauseClass() {
        return causeClass;
    }
    /** return stack trace message from service */
    public String getServiceStackTraceMessage() {
        return serviceStackTraceMessage;
    }
    /** return exception type */
    public int getType() {
        return type;
    }
    /** 
     * return cause field value string<br>
     * format be dependent on the {@code toString()} method of cause 
     */
    public String getCauseFields() {
        return causeFields;
    }
    @Override
    public String toString() {
        StringBuilder builder = new StringBuilder();
        builder.append("ServiceRuntimeException [type=");
        builder.append(type);
        builder.append(", message=");
        builder.append(message);
        builder.append(", causeClass=");
        builder.append(causeClass);
        builder.append(", causeFields=");
        builder.append(causeFields);
        builder.append(", serviceStackTraceMessage=");
        builder.append(serviceStackTraceMessage);
        builder.append("]");
        return builder.toString();
    }
}
